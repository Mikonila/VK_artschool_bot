import requests
import logging
import time
import json
import os
from config import VK_TOKEN, VK_GROUP_ID, BOT_NAME, MAX_MESSAGE_LENGTH

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

class HTTPVKAIBot:
    def __init__(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è VK –±–æ—Ç–∞ —á–µ—Ä–µ–∑ HTTP API"""
        try:
            self.vk_token = VK_TOKEN
            self.group_id = VK_GROUP_ID
            self.api_url = "https://api.vk.com/method/"
            
            
            # ID –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            self.last_message_id = 0
            
            logger.info(f"–ë–æ—Ç {BOT_NAME} —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {e}")
            raise

    def vk_api_call(self, method, params):
        """–í—ã–∑–æ–≤ VK API"""
        try:
            params['access_token'] = self.vk_token
            params['v'] = '5.131'
            
            response = requests.post(f"{self.api_url}{method}", data=params)
            result = response.json()
            
            if 'error' in result:
                raise Exception(f"VK API Error: {result['error']}")
            
            return result['response']
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ VK API: {e}")
            return None


    def send_message(self, user_id, message, keyboard=None, attachment=None):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å –≤–æ–∑–º–æ–∂–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –∏ –≤–ª–æ–∂–µ–Ω–∏—è–º–∏"""
        try:
            params = {
                'user_id': user_id,
                'message': message,
                'random_id': 0
            }
            
            if keyboard:
                params['keyboard'] = json.dumps(keyboard, ensure_ascii=False)
            
            if attachment:
                params['attachment'] = attachment
            
            result = self.vk_api_call('messages.send', params)
            
            if result:
                logger.info(f"–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id}")
            else:
                logger.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id}")
                
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")


    def create_main_keyboard(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –∫–Ω–æ–ø–∫–∞–º–∏"""
        keyboard = {
            "one_time": False,
            "buttons": [
                [
                    {
                        "action": {
                            "type": "text",
                            "label": "–û —à–∫–æ–ª–µ Helion"
                        },
                        "color": "primary"
                    }
                ],
                [
                    {
                        "action": {
                            "type": "text",
                            "label": "–ó–∞–∫–∞–∑–∞—Ç—å –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—é"
                        },
                        "color": "primary"
                    }
                ],
                [
                    {
                        "action": {
                            "type": "text",
                            "label": "–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ"
                        },
                        "color": "secondary"
                    }
                ]
            ]
        }
        return keyboard

    def create_helion_keyboard(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ '–û —à–∫–æ–ª–µ Helion' —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏"""
        keyboard = {
            "one_time": False,
            "buttons": [
                [
                    {
                        "action": {
                            "type": "open_link",
                            "label": "–ü—Ä–æ–π—Ç–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —É—Ä–æ–∫",
                            "link": "https://codim.online/helion"
                        }
                    }
                ],
                [
                    {
                        "action": {
                            "type": "text",
                            "label": "–û–Ω–ª–∞–π–Ω-—É—Ä–æ–∫ —Å —Ö—É–¥–æ–∂–Ω–∏–∫–æ–º"
                        },
                        "color": "primary"
                    }
                ],
                [
                    {
                        "action": {
                            "type": "text",
                            "label": "–ü–æ–ª—É—á–∏—Ç—å —à–ø–∞—Ä–≥–∞–ª–∫—É üé®"
                        },
                        "color": "positive"
                    }
                ],
                [
                    {
                        "action": {
                            "type": "text",
                            "label": "‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"
                        },
                        "color": "secondary"
                    }
                ]
            ]
        }
        return keyboard

    def get_new_messages(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –¥–∏–∞–ª–æ–≥–æ–≤
            result = self.vk_api_call('messages.getConversations', {
                'count': 10
            })
            
            if not result:
                return []
            
            new_messages = []
            for conv in result['items']:
                last_message = conv['last_message']
                if last_message['id'] > self.last_message_id and not last_message.get('out', False):
                    new_messages.append(last_message)
                    self.last_message_id = max(self.last_message_id, last_message['id'])
            
            return new_messages
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π: {e}")
            return []

    def handle_message(self, message):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"""
        user_id = message['from_id']
        message_text = message['text']
        
        logger.info(f"–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}: {message_text}")
        
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—ã
        if message_text.lower() in ['/start', '–Ω–∞—á–∞—Ç—å', '—Å—Ç–∞—Ä—Ç']:
            help_message = f"""–ü—Ä–∏–≤–µ—Ç! –Ø —á–∞—Ç-–±–æ—Ç —à–∫–æ–ª—ã —Ä–∏—Å–æ–≤–∞–Ω–∏—è –∞–Ω–∏–º–µ ¬´Helion¬ª. –ú–æ–∂–µ—à—å –Ω–∞–ø–∏—Å–∞—Ç—å –º–Ω–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –Ω–∞–∂–∞—Ç—å –Ω–∞ –æ–¥–Ω—É –∏–∑ –∫–Ω–æ–ø–æ–∫ –Ω–∏–∂–µ."""
            keyboard = self.create_main_keyboard()
            self.send_message(user_id, help_message, keyboard)
            return
        
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ –º–µ–Ω—é
        if message_text == "‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é":
            help_message = f"""–ü—Ä–∏–≤–µ—Ç! –Ø —á–∞—Ç-–±–æ—Ç —à–∫–æ–ª—ã —Ä–∏—Å–æ–≤–∞–Ω–∏—è –∞–Ω–∏–º–µ ¬´Helion¬ª. –ú–æ–∂–µ—à—å –Ω–∞–ø–∏—Å–∞—Ç—å –º–Ω–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –Ω–∞–∂–∞—Ç—å –Ω–∞ –æ–¥–Ω—É –∏–∑ –∫–Ω–æ–ø–æ–∫ –Ω–∏–∂–µ."""
            keyboard = self.create_main_keyboard()
            self.send_message(user_id, help_message, keyboard)
            return
        
        if message_text == "–û —à–∫–æ–ª–µ Helion":
            # –ü–µ—Ä–≤–∞—è —á–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
            first_part = """
Helion ‚Äî —ç—Ç–æ –æ–Ω–ª–∞–π–Ω-—à–∫–æ–ª–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è –≤ –∞–Ω–∏–º–µ-—Å—Ç–∏–ª–µ, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ç—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–º–æ—Ç—Ä–∏—à—å —É—Ä–æ–∫–∏, –∞ —Ä–∞—Å—Ç—ë—à—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, –Ω–∞—Ö–æ–¥—è—Å—å –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ –∏–∑ –±–æ–ª–µ–µ 150 –∞–Ω–∏–º–µ-—Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤!
–ú—ã —Å–æ–±—Ä–∞–ª–∏ –ª—É—á—à–∏–µ –º–µ—Ç–æ–¥–∏–∫–∏ –∏ –æ–ø—ã—Ç —Ü–µ–ª–æ–≥–æ –∫–æ–º—å—é–Ω–∏—Ç–∏ ‚Äî –∏ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ –≤ –≤–∏–¥–µ–æ–∫—É—Ä—Å, –∫–æ—Ç–æ—Ä—ã–π —Ç—ã –º–æ–∂–µ—à—å –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≤ —É–¥–æ–±–Ω–æ–º —Ç–µ–º–ø–µ, –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±—â–∞—Ç—å—Å—è —Å —Ç–µ–º–∏, –∫—Ç–æ —É–∂–µ –ø—Ä–æ—à–µ–ª —ç—Ç–æ—Ç –ø—É—Ç—å.

üéÜ –í –Ω–∞—à–µ–π —à–∫–æ–ª–µ –µ—Å—Ç—å –∑–∞–∫—Ä—ã—Ç—ã–π —á–∞—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–ø—ã—Ç–Ω—ã–µ —Ö—É–¥–æ–∂–Ω–∏–∫–∏ –¥–µ–ª—è—Ç—Å—è —Å–≤–æ–∏–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏, —Ä–∞–∑–±–∏—Ä–∞—é—Ç –æ—à–∏–±–∫–∏, –¥–∞—é—Ç —Å–æ–≤–µ—Ç—ã –∏ –ø–æ–º–æ–≥–∞—é—Ç —Ä–∞—Å—Ç–∏ –±—ã—Å—Ç—Ä–µ–µ –∏ —Å –∫–∞–∂–¥—ã–º —Ä–∞–∑–æ–º —Ä–∏—Å–æ–≤–∞—Ç—å –≤—Å—ë –ª—É—á—à–µ –∏ –ª—É—á—à–µ. 
"""
            
            # –í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è (–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥)
            second_part = """
üë©‚Äçüéì –ß—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ –∫—É—Ä—Å:

‚Äì 10 –≤–∏–¥–µ–æ-—É—Ä–æ–∫–æ–≤ ‚Äî –æ—Ç —Å–∫–µ—Ç—á–∞ –¥–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
‚Äì –ö–∞–∂–¥—ã–π —É—Ä–æ–∫ –∑–∞–ø–∏—Å–∞–Ω —Ä–∞–∑–Ω—ã–º–∏ —Ö—É–¥–æ–∂–Ω–∏–∫–∞–º–∏ ‚Äì —É–≤–∏–¥–∏—à—å —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ —Ä–∏—Å–æ–≤–∞–Ω–∏—é
‚Äì 15 —Å–ø–∏–¥–ø–µ–π–Ω—Ç–æ–≤ ‚Äî –Ω–∞–≥–ª—è–¥–Ω–æ —É–≤–∏–¥–∏—à—å, –∫–∞–∫ —Ä–∏—Å—É—é—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ö—É–¥–æ–∂–Ω–∏–∫–∏
‚Äì 7 –æ–±–∑–æ—Ä–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º ‚Äî –Ω–∞—É—á–∏—à—å—Å—è —Ä–∏—Å–æ–≤–∞—Ç—å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –∏ –Ω–∞ –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
‚Äì –î–æ–º–∞—à–∫–∞ 2-—Ö —É—Ä–æ–≤–Ω–µ–π ‚Äî —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏ –¥–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ (—Ç–µ—Å—Ç—ã, —Ç—É—Ç–æ—Ä–∏–∞–ª—ã, —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã)
‚Äì –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ —á–∞—Ç–µ 24/7 ‚Äî —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤ –æ—Ç–≤–µ—Ç–∏—Ç –Ω–∞ —Ç–≤–æ–π –≤–æ–ø—Ä–æ—Å –∏ —Ä–∞–∑–±–µ—Ä–µ—Ç –æ—à–∏–±–∫–∏ —Å —Ä–∞–∑–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω
‚Äì –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç ‚Äî –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Ç–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

‚ú® –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫ (–≤–∏–¥–µ–æ + –º–∞—Ç–µ—Ä–∏–∞–ª—ã)"""
            
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ Helion
            keyboard_with_link = self.create_helion_keyboard()
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—É—é —á–∞—Å—Ç—å —Å—Ä–∞–∑—É
            self.send_message(user_id, first_part)
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å —á–µ—Ä–µ–∑ 15 —Å–µ–∫—É–Ω–¥ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
            import threading
            
            def send_second_part():
                time.sleep(15)  # –ó–∞–¥–µ—Ä–∂–∫–∞ 15 —Å–µ–∫—É–Ω–¥
                self.send_message(user_id, second_part, keyboard_with_link)
            
            thread = threading.Thread(target=send_second_part)
            thread.daemon = True
            thread.start()
            
            return
        
        elif message_text == "–ö–∞–∫–∏–µ —Å–µ–π—á–∞—Å –µ—Å—Ç—å –∞–∫—Ü–∏–∏?":
            response = """üéâ –¢–µ–∫—É—â–∏–µ –∞–∫—Ü–∏–∏ –∏ —Å–∫–∏–¥–∫–∏

–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –∞–∫—Ü–∏–π –Ω–µ—Ç"""
            keyboard = self.create_main_keyboard()
            self.send_message(user_id, response, keyboard)
            return
        
        elif message_text == "–ó–∞–∫–∞–∑–∞—Ç—å –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—é":
            response = """
–ú—ã —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏ –≤ —Å—Ç–∏–ª–µ –∞–Ω–∏–º–µ –∏ –º—É–ª—å—Ç—Å–µ—Ä–∏–∞–ª–æ–≤!

–ù–∞—à–∏ —É—Å–ª—É–≥–∏:
‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –∏ –ø–æ—Ä—Ç—Ä–µ—Ç—ã
‚Ä¢ –û–±–ª–æ–∂–∫–∏ –¥–ª—è –∫–Ω–∏–≥, –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö –∞–ª—å–±–æ–º–æ–≤
‚Ä¢ –ö–æ–Ω—Ü–µ–ø—Ç-–∞—Ä—Ç –¥–ª—è –∏–≥—Ä
‚Ä¢ –í—Ç—É–± –º–æ–¥–µ–ª–∏
‚Ä¢ –§–∞–Ω-–∞—Ä—Ç –ø–æ –≤–∞—à–∏–º –ª—é–±–∏–º—ã–º –∞–Ω–∏–º–µ
‚Ä¢ –õ–æ–≥–æ—Ç–∏–ø—ã –∏ –¥–∏–∑–∞–π–Ω

–ö–∞–∫ –∑–∞–∫–∞–∑–∞—Ç—å:
1. –û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –∏–¥–µ—é
2. –ü—Ä–∏—à–ª–∏—Ç–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
3. –£–∫–∞–∂–∏—Ç–µ —Å—Ä–æ–∫–∏

–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å—é–¥–∞, –∑–∞—Ç–µ–º —è —Å–æ—Ä–∏–µ–Ω—Ç–∏—Ä—É—é –≤–∞—Å –ø–æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏!"""
            keyboard = self.create_main_keyboard()
            self.send_message(user_id, response, keyboard)
            return
        
        
        elif message_text == "–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ":
            response = """–ú—ã –æ—Ç–∫—Ä—ã—Ç—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞!

–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
‚Ä¢ –ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ —Å –¥—Ä—É–≥–∏–º–∏ —à–∫–æ–ª–∞–º–∏ –∏ —Å—Ç—É–¥–∏—è–º–∏
‚Ä¢ –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
‚Ä¢ –ö–æ–Ω—Ç–µ–Ω—Ç-–ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ —Å –±–ª–æ–≥–µ—Ä–∞–º–∏
–ù–∞–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç, –≤ —Å–≤–æ–±–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–µ, –∏ –∫—É—Ä–∞—Ç–æ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏.

–û—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤: –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–≤–æ—ë —Ä–µ–∑—é–º–µ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º @NPnnn28, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–∞—à–µ–π –∫–æ–º–∞–Ω–¥–µ.
"""
            keyboard = self.create_main_keyboard()
            self.send_message(user_id, response, keyboard)
            return
        
        
        elif message_text == "–û–Ω–ª–∞–π–Ω-—É—Ä–æ–∫ —Å —Ö—É–¥–æ–∂–Ω–∏–∫–æ–º":
            response = """
–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è —Å –∞–Ω–∏–º–µ-—Ö—É–¥–æ–∂–Ω–∏–∫–æ–º!


–ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:
‚úÖ –ñ–∏–≤–æ–π —É—Ä–æ–∫ —Å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º –ø–æ –≤–∏–¥–µ–æ
‚úÖ –ó–∞–ø–∏—Å—å –∑–∞–Ω—è—Ç–∏–π
‚úÖ –î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ –¥–∑
‚úÖ –ë–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
‚úÖ –í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è

–°—Ç–æ–∏–º–æ—Å—Ç—å:
‚Ä¢ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —É—Ä–æ–∫ - 1 200‚ÇΩ/45 –º–∏–Ω—É—Ç
‚Ä¢ –ú–µ—Å—è—á–Ω—ã–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç (2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é, 8 –∑–∞–Ω—è—Ç–∏–π) - 8 800‚ÇΩ
–ü—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫ –¥–ª–∏—Ç—Å—è 1 —á–∞—Å, —á—Ç–æ–±—ã –º—ã —É—Å–ø–µ–ª–∏ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ!

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∑–∞–Ω—è—Ç–∏–µ, –Ω–∞–ø–∏—à–∏ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è, –∏ –º—ã –Ω–∞–∑–Ω–∞—á–∏–º –≤—Å—Ç—Ä–µ—á—É!"""
            keyboard = self.create_main_keyboard()
            self.send_message(user_id, response, keyboard)
            return
        
        elif message_text == "–ü–æ–ª—É—á–∏—Ç—å —à–ø–∞—Ä–≥–∞–ª–∫—É üé®":
            # –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ Google Drive
            message = """
–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ Google –¥–∏—Å–∫–µ:
https://drive.google.com/drive/folders/1dcjhHqBBC424uqfTQxEgRIRNRwR4VYLe?usp=sharing

–í –ø–∞–ø–∫–µ —Ç—ã –Ω–∞–π–¥–µ—à—å:
‚Ä¢ üëÅÔ∏è –®–ø–∞—Ä–≥–∞–ª–∫—É –ø–æ —Ä–∏—Å–æ–≤–∞–Ω–∏—é –≥–ª–∞–∑
‚Ä¢ üìö PDF —Å —Å–æ–≤–µ—Ç–∞–º–∏ –∏ –ª–∞–π—Ñ—Ö–∞–∫–∞–º–∏

–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã, –Ω–∞–ø–∏—à–∏ –∏—Ö –≤ —Å–≤–æ–±–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–µ, –∏ —è –æ—Ç–≤–µ—á—É!"""
            keyboard = self.create_main_keyboard()
            self.send_message(user_id, message, keyboard)
            return
        
        # –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ –∫–Ω–æ–ø–∫–∞, –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ–º
        return

    def run(self):
        """–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞"""
        logger.info("–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –æ–ø—Ä–æ—Å–∞...")
        
        try:
            while True:
                messages = self.get_new_messages()
                for message in messages:
                    self.handle_message(message)
                
                time.sleep(2)  # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
                
        except KeyboardInterrupt:
            logger.info("–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
        except Exception as e:
            logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
            raise

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    try:
        bot = HTTPVKAIBot()
        bot.run()
    except Exception as e:
        logger.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞: {e}")
        print(f"–û—à–∏–±–∫–∞: {e}")
        print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ .env")

if __name__ == "__main__":
    main()
